rustc: Restrict the scope of a borrow on def_map