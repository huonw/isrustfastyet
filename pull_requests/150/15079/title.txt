Refactor the unification code and rejuvenate the unit test infrastructure