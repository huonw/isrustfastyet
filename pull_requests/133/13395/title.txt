path: Refactor set_extension and contains_nul