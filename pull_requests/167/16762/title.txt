Improve the diagnostics for mistakes in for loops