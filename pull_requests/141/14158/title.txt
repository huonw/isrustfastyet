Factor out foldable better to reduce code duplication. 