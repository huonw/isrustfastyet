Refactor and fix FIXME's in mtwt hygiene code