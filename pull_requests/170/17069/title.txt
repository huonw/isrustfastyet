Visitor: remove context and add lifetimes.